---
import ScrollableContent from '../components/ScrollableContent.svelte';
import SidebarLayout from '../layouts/SidebarLayout.astro';

const title = 'Rafael Cacilhas';
const description = 'A portfolio-slash-blog.';
const permalink = Astro.site?.href || '';

let allProjects = await Astro.glob('../data/projects/*.md');
allProjects = allProjects.sort((a, b) => new Date(b.frontmatter.publishDate).valueOf() - new Date(a.frontmatter.publishDate).valueOf());

let allPosts = await Astro.glob('../data/blog-posts/*.md');
allPosts = allPosts.sort((a, b) => new Date(b.frontmatter.publishDate).valueOf() - new Date(a.frontmatter.publishDate).valueOf());

const projects = allProjects.map((item) => {
  return {
    title: item.frontmatter.title,
    description: item.frontmatter.description,
    image: item.frontmatter.image,
    link: item.frontmatter.link,
    tags: item.frontmatter.tags || [],
    role: item.frontmatter.role,
    duration: item.frontmatter.duration,
    servingInfo: item.frontmatter.servingInfo,
    contributions: item.frontmatter.contributions
   }
}
)

const posts = allPosts.map((item) => {
  return {
    title: item.frontmatter.title,
    description: item.frontmatter.description,
    link: item.frontmatter.link,
    publishDate: item.frontmatter.publishDate
  }
}
)
---

<SidebarLayout title={title} description={description} permalink={permalink} >
  <ScrollableContent projects={projects} posts={posts} client:load />
</SidebarLayout>
